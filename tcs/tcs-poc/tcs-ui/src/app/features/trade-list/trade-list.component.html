<div class="trade-list-container">
  <!-- Toolbar -->
  <mat-toolbar color="primary" class="trade-list-toolbar">
    <span class="toolbar-title">Trade List</span>
    <span class="toolbar-spacer"></span>
    <button mat-raised-button color="accent" (click)="onCreateTrade()">
      <mat-icon>add</mat-icon>
      New Trade
    </button>
    <button mat-icon-button (click)="onRefresh()" matTooltip="Refresh">
      <mat-icon>refresh</mat-icon>
    </button>
  </mat-toolbar>

  <!-- Filter Section -->
  <div class="filter-section">
    <app-trade-filter (filterChange)="onFilterChange($event)"></app-trade-filter>
  </div>

  <!-- Main Content -->
  <mat-card class="trade-list-card">
    <!-- Loading Spinner -->
    <div *ngIf="loading()" class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Loading trades...</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="error()" class="error-container">
      <mat-icon color="warn">error</mat-icon>
      <p>{{ error() }}</p>
      <button mat-raised-button color="primary" (click)="onRefresh()">
        Retry
      </button>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading() && !error() && !hasTrades()" class="empty-state">
      <mat-icon>inbox</mat-icon>
      <h2>No Trades Found</h2>
      <p>Get started by creating your first trade</p>
      <button mat-raised-button color="primary" (click)="onCreateTrade()">
        <mat-icon>add</mat-icon>
        Create Trade
      </button>
    </div>

    <!-- Trade Table -->
    <div *ngIf="!loading() && !error() && hasTrades()" class="table-container">
      <table 
        mat-table 
        [dataSource]="paginatedTrades()" 
        matSort
        (matSortChange)="onSortChange($event)"
        class="trade-table">

        <!-- Trade ID Column -->
        <ng-container matColumnDef="tradeId">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Trade ID</th>
          <td mat-cell *matCellDef="let trade">{{ getTradeId(trade) }}</td>
        </ng-container>

        <!-- Label Column -->
        <ng-container matColumnDef="label">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Label</th>
          <td mat-cell *matCellDef="let trade">{{ getTradeLabel(trade) }}</td>
        </ng-container>

        <!-- Trade Type Column -->
        <ng-container matColumnDef="tradeType">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Type</th>
          <td mat-cell *matCellDef="let trade">
            <span class="trade-type-badge">{{ getTradeType(trade) }}</span>
          </td>
        </ng-container>

        <!-- Book Column -->
        <ng-container matColumnDef="book">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Book</th>
          <td mat-cell *matCellDef="let trade">{{ getBook(trade) }}</td>
        </ng-container>

        <!-- Counterparty Column -->
        <ng-container matColumnDef="counterparty">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Counterparty</th>
          <td mat-cell *matCellDef="let trade">{{ getCounterparty(trade) }}</td>
        </ng-container>

        <!-- Trade Date Column -->
        <ng-container matColumnDef="tradeDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Trade Date</th>
          <td mat-cell *matCellDef="let trade">{{ getTradeDate(trade) }}</td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let trade">
            <button 
              mat-icon-button 
              color="primary" 
              (click)="onRowClick(trade); $event.stopPropagation()"
              matTooltip="View Details">
              <mat-icon>visibility</mat-icon>
            </button>
          </td>
        </ng-container>

        <!-- Table Rows -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr 
          mat-row 
          *matRowDef="let row; columns: displayedColumns;"
          class="trade-row"
          (click)="onRowClick(row)">
        </tr>
      </table>

      <!-- Paginator -->
      <mat-paginator
        [length]="totalTrades()"
        [pageSize]="pageSize()"
        [pageIndex]="pageIndex()"
        [pageSizeOptions]="pageSizeOptions"
        (page)="onPageChange($event)"
        showFirstLastButtons>
      </mat-paginator>
    </div>
  </mat-card>
</div>
